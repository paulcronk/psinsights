import pandas as pd
from psinsights import Service

# my Google API key
service = Service('AIzaSyA3FfXgcx1LF5wLNUjVrFB9ioJ8cQrRgkM')
# list of URLs
# url = pd.read_csv('pagespeed-pages.csv', encoding='utf-8')
url = [['https://www.gov.uk/state-pension-statement','answer','34813','1.219303797'] ,['https://www.gov.uk/national-minimum-wage-rates','answer','24177','2.856219251'] ,['https://www.gov.uk/benefits-calculators','answer','23935','1.519576531'] ,['https://www.gov.uk/log-in-file-self-assessment-tax-return','answer','23827','1.154394444'] ,['https://www.gov.uk/contact-jobcentre-plus','answer','20824','2.394494505'] ,['https://www.gov.uk/apply-apprenticeship','answer','19869','1.300266304'] ,['https://www.gov.uk/renew-adult-passport','answer','15995','1.72025'] ,['https://www.gov.uk/apply-national-insurance-number','answer','14841','2.092070922'] ,['https://www.gov.uk/dbs-update-service','answer','12506','1.814809917'] ,['https://www.gov.uk/call-charges','answer','11595','1.308873786'] ,['https://www.gov.uk/browse/driving','browse','46142','2.216964467'] ,['https://www.gov.uk/browse/visas-immigration','browse','35139','2.55406338'] ,['https://www.gov.uk/browse/driving/driving-licences','browse','31689','2.048969231'] ,['https://www.gov.uk/browse/driving/car-tax-discs','browse','29195','1.843537549'] ,['https://www.gov.uk/browse/benefits','browse','27087','2.068144144'] ,['https://www.gov.uk/browse/working','browse','13067','1.637159664'] ,['https://www.gov.uk/browse/abroad/passports','browse','12832','1.113021739'] ,['https://www.gov.uk/browse/benefits/tax-credits','browse','12642','1.957521739'] ,['https://www.gov.uk/browse/visas-immigration/tourist-short-stay-visas','browse','11419','2.061944444'] ,['https://www.gov.uk/browse/working/state-pension','browse','10708','1.77175'] ,['https://www.gov.uk/start-up-loans','business_support','972','1.7120625'] ,['https://www.gov.uk/child-benefit-tax-calculator/main','calculator','4044','0.921181818'] ,['https://www.gov.uk/child-benefit-tax-calculator','calculator','2426','1.294333333'] ,['https://www.gov.uk/bank-holidays','calendar','43284','3.233378613'] ,['https://www.gov.uk/when-do-the-clocks-change','calendar','418','1.118333333'] ,['https://www.gov.uk/yourstatepension','campaign','16972','3.183391608'] ,['https://www.gov.uk/vehicletaxrules','campaign','1005','0.776125'] ,['https://www.gov.uk/dla-ending','campaign','524','3.038333333'] ,['https://www.gov.uk/studentfinancesteps','campaign','504','1.264857143'] ,['https://www.gov.uk/knowbeforeyougo','campaign','465','1.162888889'] ,['https://www.gov.uk/statepensiontopup','campaign','442','1.372666667'] ,['https://www.gov.uk/dotherightthing','campaign','429','0'] ,['https://www.gov.uk/let-property-campaign','campaign','314','1.778'] ,['https://www.gov.uk/civil-service-apprenticeships','campaign','303','0'] ,['https://www.gov.uk/employment-allowance','campaign','293','6.604333333'] ,['https://www.gov.uk/done/vehicle-tax','completed_transaction','44833','1.635160606'] ,['https://www.gov.uk/done/check-vehicle-tax','completed_transaction','12547','1.949822222'] ,['https://www.gov.uk/done/view-driving-licence','completed_transaction','11875','1.369545455'] ,['https://www.gov.uk/driving-transaction-finished','completed_transaction','10203','2.162956044'] ,['https://www.gov.uk/done/make-a-sorn','completed_transaction','6107','1.82912766'] ,['https://www.gov.uk/transaction-finished','completed_transaction','3497','6.260925926'] ,['https://www.gov.uk/done/book-driving-test','completed_transaction','3164','2.864809524'] ,['https://www.gov.uk/done/overseas-passports','completed_transaction','2068','1.935352941'] ,['https://www.gov.uk/done/change-date-practical-driving-test','completed_transaction','1160','12.916'] ,['https://www.gov.uk/done/marriage-allowance','completed_transaction','1142','0.878333333'] ,['https://www.gov.uk/guidance/rules-for-all-agency-staff-working-in-the-nhs','detailed_guidance','7496','1.294448276'] ,['https://www.gov.uk/guidance/tax-professional-development-programme','detailed_guidance','5504','7.017717949'] ,['https://www.gov.uk/guidance/hmrc-tools-and-calculators','detailed_guidance','4044','1.753296296'] ,['https://www.gov.uk/guidance/annual-tax-summary','detailed_guidance','3784','2.552166667'] ,['https://www.gov.uk/guidance/civil-service-fast-stream-graduate-schemes','detailed_guidance','3385','3.483916667'] ,['https://www.gov.uk/guidance/rates-of-vat-on-different-goods-and-services','detailed_guidance','3235','1.510206897'] ,['https://www.gov.uk/guidance/hmrc-online-services-for-agents','detailed_guidance','2988','0.667466667'] ,['https://www.gov.uk/guidance/rates-and-thresholds-for-employers-2015-to-2016','detailed_guidance','2737','1.418315789'] ,['https://www.gov.uk/guidance/civil-service-fast-stream-how-to-apply','detailed_guidance','2684','1.953529412'] ,['https://www.gov.uk/guidance/jobcentres-where-you-can-claim-universal-credit','detailed_guidance','2592','2.367555556'] ,['https://www.gov.uk/business-finance-support-finder','finder','1738','3.195333333'] ,['https://www.gov.uk/licence-finder','finder','547','3.327636364'] ,['https://www.gov.uk/log-in-register-hmrc-online-services','guide','50642','0.826572016'] ,['https://www.gov.uk/new-state-pension','guide','23603','1.011604938'] ,['https://www.gov.uk/standard-visitor-visa','guide','18049','1.668475862'] ,['https://www.gov.uk/self-assessment-tax-returns','guide','13045','1.298958904'] ,['https://www.gov.uk/new-state-pension/eligibility','guide','12295','1.084675'] ,['https://www.gov.uk/vehicle-tax-rate-tables','guide','11966','1.008349057'] ,['https://www.gov.uk/new-state-pension/your-national-insurance-record-and-your-state-pension','guide','10538','0.81982716'] ,['https://www.gov.uk/income-tax-rates/current-rates-and-allowances','guide','10410','2.142561798'] ,['https://www.gov.uk/income-tax-rates','guide','10294','1.080239583'] ,['https://www.gov.uk/disclosure-barring-service-check/overview','guide','9603','2.194105882'] ,['https://www.gov.uk/help/beta','help_page','2013','1.325045455'] ,['https://www.gov.uk/help','help_page','1488','2.532444444'] ,['https://www.gov.uk/help/browsers','help_page','962','1.03675'] ,['https://www.gov.uk/help/cookies','help_page','894','0.8865'] ,['https://www.gov.uk/shotgun-and-firearm-certificates','licence','1008','3.007833333'] ,['https://www.gov.uk/waste-carrier-or-broker-registration','licence','772','2.9164'] ,['https://www.gov.uk/tv-licence','licence','745','2.874777778'] ,['https://www.gov.uk/hazardous-waste-producer-registration','licence','638','1.6565'] ,['https://www.gov.uk/food-business-registration','licence','564','1.3205'] ,['https://www.gov.uk/premises-licence','licence','427','1.614666667'] ,['https://www.gov.uk/temporary-events-notice','licence','400','0.324333333'] ,['https://www.gov.uk/house-in-multiple-occupation-licence','licence','375','0.900333333'] ,['https://www.gov.uk/food-premises-approval','licence','226','0.174'] ,['https://www.gov.uk/apply-for-elderly-person-bus-pass','local_transaction','3980','3.122416667'] ,['https://www.gov.uk/pay-council-tax','local_transaction','3418','1.903'] ,['https://www.gov.uk/school-term-holiday-dates','local_transaction','2977','2.5635'] ,['https://www.gov.uk/apply-council-tax-reduction','local_transaction','2642','1.2397'] ,['https://www.gov.uk/get-on-electoral-register','local_transaction','2197','0.760692308'] ,['https://www.gov.uk/apply-for-council-housing','local_transaction','2092','1.5024'] ,['https://www.gov.uk/apply-for-primary-school-place','local_transaction','2089','1.674052632'] ,['https://www.gov.uk/blue-badge-scheme-information-council','local_transaction','1684','1.2054375'] ,['https://www.gov.uk/apply-for-council-tax-discount','local_transaction','1469','0.6258'] ,['https://www.gov.uk/apply-housing-benefit-from-council','local_transaction','1407','1.347666667'] ,['https://www.gov.uk/government/news/pm-pledges-178-billion-investment-in-defence-kit','news','15003','3.355344828'] ,['https://www.gov.uk/government/news/driving-licence-changes','news','5418','6.122755102'] ,['https://www.gov.uk/government/news/strategic-defence-and-security-review-178bn-of-equipment-spending','news','5107','1.443596491'] ,['https://www.gov.uk/government/news/vehicle-tax-changes','news','2773','3.777789474'] ,['https://www.gov.uk/government/news/launch-of-the-new-companies-house-public-beta-service','news','2766','1.667133333'] ,['https://www.gov.uk/government/news/spending-review-and-autumn-statement-2015-everything-you-need-to-know','news','2285','1.5153'] ,['https://www.gov.uk/government/news/new-national-minimum-wage-rates-announced','news','1796','1.918947368'] ,['https://www.gov.uk/government/news/immigration-rules-changes','news','1745','2.059909091'] ,['https://www.gov.uk/government/news/hiring-a-vehicle','news','1570','4.169105263'] ,['https://www.gov.uk/government/news/transport-direct-website-closes-on-30-september-2014','news','1336','3.171'] ,['https://www.gov.uk/driving-theory-test-centre','place','6327','2.102966667'] ,['https://www.gov.uk/find-regional-passport-office','place','2307','0.7275'] ,['https://www.gov.uk/number-plate-supplier','place','1801','0.857904762'] ,['https://www.gov.uk/passport-interview-office','place','1306','0.9125'] ,['https://www.gov.uk/compulsory-basic-training-cbt-courses','place','973','0.9488'] ,['https://www.gov.uk/health-protection-team','place','582','0'] ,['https://www.gov.uk/valuation-offices-council-tax','place','502','0.6431'] ,['https://www.gov.uk/find-atf-dvsa-test-station','place','396','1.2215'] ,['https://www.gov.uk/valuation-offices-business-rates','place','371','1.0074'] ,['https://www.gov.uk/jobseekers-allowance/how-to-claim','programme','26268','2.018279352'] ,['https://www.gov.uk/winter-fuel-payment/what-youll-get','programme','10278','1.329034483'] ,['https://www.gov.uk/jobseekers-allowance','programme','10160','1.090428571'] ,['https://www.gov.uk/the-warm-home-discount-scheme/eligibility','programme','9963','1.359730337'] ,['https://www.gov.uk/winter-fuel-payment/overview','programme','9818','3.576972973'] ,['https://www.gov.uk/employment-support-allowance/how-to-claim','programme','9549','1.757507246'] ,['https://www.gov.uk/state-pension','programme','9461','1.384273973'] ,['https://www.gov.uk/jobseekers-allowance/what-youll-get','programme','9416','1.370740741'] ,['https://www.gov.uk/winter-fuel-payment/eligibility','programme','8195','1.312723684'] ,['https://www.gov.uk/jobseekers-allowance/overview','programme','7996','2.468888889'] ,['https://www.gov.uk/contact-the-dvla','simple_smart_answer','67285','1.340844275'] ,['https://www.gov.uk/sold-bought-vehicle','simple_smart_answer','48938','0.834321256'] ,['https://www.gov.uk/claim-state-pension-online','simple_smart_answer','18734','0.800681081'] ,['https://www.gov.uk/settle-in-the-uk','simple_smart_answer','18030','0.842275862'] ,['https://www.gov.uk/qualify-tax-credits','simple_smart_answer','14176','1.254320755'] ,['https://www.gov.uk/check-if-you-need-a-tax-return','simple_smart_answer','13261','1.275118644'] ,['https://www.gov.uk/legal-right-work-uk','simple_smart_answer','11480','0.775511364'] ,['https://www.gov.uk/vehicles-can-drive','simple_smart_answer','10631','1.28504'] ,['https://www.gov.uk/exchange-foreign-driving-licence','simple_smart_answer','8722','0.932708333'] ,['https://www.gov.uk/register-employer','simple_smart_answer','7241','0.35296875'] ,['https://www.gov.uk/calculate-state-pension','smart_answer','209709','1.458507524'] ,['https://www.gov.uk/calculate-your-holiday-entitlement','smart_answer','89237','1.017816327'] ,['https://www.gov.uk/check-uk-visa','smart_answer','66588','2.021836538'] ,['https://www.gov.uk/calculate-your-child-maintenance','smart_answer','61710','1.3772'] ,['https://www.gov.uk/pay-leave-for-parents','smart_answer','42498','0.907447761'] ,['https://www.gov.uk/calculate-your-redundancy-pay','smart_answer','36707','1.06484'] ,['https://www.gov.uk/overseas-passports','smart_answer','35198','1.970664557'] ,['https://www.gov.uk/student-finance-calculator','smart_answer','30292','1.011'] ,['https://www.gov.uk/maternity-paternity-calculator','smart_answer','29674','0.761263158'] ,['https://www.gov.uk/calculate-statutory-sick-pay','smart_answer','20076','0.94472973'] ,['https://www.gov.uk/topic/personal-tax/self-assessment','specialist-sector','21682','0.990937107'] ,['https://www.gov.uk/topic/business-tax/vat','specialist-sector','13791','1.080437086'] ,['https://www.gov.uk/topic/further-education-skills/apprenticeships','specialist-sector','10731','1.311082474'] ,['https://www.gov.uk/topic/business-tax/paye','specialist-sector','9577','0.912146667'] ,['https://www.gov.uk/topic/personal-tax/income-tax','specialist-sector','7551','1.434885714'] ,['https://www.gov.uk/topic/dealing-with-hmrc/paying-hmrc','specialist-sector','6383','1.312692308'] ,['https://www.gov.uk/topic/dealing-with-hmrc/tax-agent-guidance','specialist-sector','4669','0.888595745'] ,['https://www.gov.uk/topic/company-registration-filing/starting-company','specialist-sector','4305','0.660470588'] ,['https://www.gov.uk/topic/immigration-operational-guidance','specialist-sector','4123','0.813393939'] ,['https://www.gov.uk/topic/intellectual-property/trade-marks','specialist-sector','4053','1.324046512'] ,['https://www.gov.uk/jobsearch','transaction','207334','2.962757174'] ,['https://www.gov.uk/vehicle-tax','transaction','136397','2.165168059'] ,['https://www.gov.uk/get-information-about-a-company','transaction','100752','0.814701639'] ,['https://www.gov.uk/view-driving-licence','transaction','64451','2.671084428'] ,['https://www.gov.uk/check-vehicle-tax','transaction','64176','2.164921495'] ,['https://www.gov.uk/pay-dartford-crossing-charge','transaction','52592','2.313284536'] ,['https://www.gov.uk/change-driving-test','transaction','44668','2.849493464'] ,['https://www.gov.uk/get-vehicle-information-from-dvla','transaction','38636','2.067947674'] ,['https://www.gov.uk/register-to-vote','transaction','38269','3.599299674'] ,['https://www.gov.uk/student-finance-register-login','transaction','34291','2.590355482'] ,['https://www.gov.uk/foreign-travel-advice','travel-advice','44509','1.692910053'] ,['https://www.gov.uk/foreign-travel-advice/belgium','travel-advice','39118','2.153621908'] ,['https://www.gov.uk/foreign-travel-advice/france','travel-advice','22263','2.735241379'] ,['https://www.gov.uk/foreign-travel-advice/egypt','travel-advice','11271','2.829029703'] ,['https://www.gov.uk/foreign-travel-advice/germany','travel-advice','5421','1.413171429'] ,['https://www.gov.uk/foreign-travel-advice/turkey','travel-advice','5181','2.394065217'] ,['https://www.gov.uk/foreign-travel-advice/morocco','travel-advice','3875','2.059464286'] ,['https://www.gov.uk/foreign-travel-advice/belgium/terrorism','travel-advice','3583','1.00875'] ,['https://www.gov.uk/foreign-travel-advice/usa','travel-advice','3558','3.112742857'] ,['https://www.gov.uk/foreign-travel-advice/spain','travel-advice','2973','1.952590909']]

# define dataframe
headings = ['URL', 'Format', 'Pageviews', 'Page load time', 'Title', 'PageSpeed score', 'Total Resource count', 'Total Request Bytes', 'Static Resource count', 'CSS Resource count', 'CSS Response Bytes', 'Flash Response Bytes', 'Host Count', 'HTML Response Bytes', 'Image Response Bytes', 'JavaScript Resource Count', 'JavaScript Response Bytes', 'Text Response Bytes', 'Other Response Bytes']
table = []
speed = pd.DataFrame(columns=headings, data=table)

# loop through each url
for page in url:
    analysis = service.analyze(page[0])
    stats = analysis.statistics
    # get data into list
    newrow = [page[0], page[1], page[2], page[3], analysis.title, analysis.score, stats.resource_count,
     stats.total_request_bytes, stats.static_resource_count,
     stats.css_resource_count, stats.css_response_bytes,
     stats.flash_response_bytes, stats.host_count,
     stats.html_response_bytes, stats.image_response_bytes,
     stats.javascript_resource_count,
     stats.javascript_response_bytes, stats.text_response_bytes,
     stats.other_response_bytes]
    # turn data list  into dataframe
    newrowdf = pd.Series(newrow, index=headings)
    # append dataframe to main dataframe
    speed = speed.append(newrowdf, ignore_index=True)

print speed
speed.to_csv('pagespeed-results.csv',encoding='utf-8')