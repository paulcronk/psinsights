import pandas as pd
from psinsights import Service

# my Google API key
service = Service('AIzaSyA3FfXgcx1LF5wLNUjVrFB9ioJ8cQrRgkM')
# list of URLs
# url = pd.read_csv('pagespeed-pages.csv', encoding='utf-8')

url = [['https://www.gov.uk/national-minimum-wage-rates','answer','659310','2.602313863','1.864345121','0.080800259','5410'] ,['https://www.gov.uk/benefits-calculators','answer','579682','1.817202545','1.303122652','0.207799784','4636'] ,['https://www.gov.uk/state-pension-statement','answer','553982','1.299548217','0.828769003','0.047087204','4739'] ,['https://www.gov.uk/log-in-file-self-assessment-tax-return','answer','542504','1.257700302','0.790538384','0.055064242','4965'] ,['https://www.gov.uk/apply-apprenticeship','answer','473757','1.614386391','1.101233627','0.036795812','4203'] ,['https://www.gov.uk/contact-jobcentre-plus','answer','411175','2.52197478','1.693368049','0.091542866','3410'] ,['https://www.gov.uk/renew-adult-passport','answer','367061','1.944272489','1.212711987','0.05119179','3046'] ,['https://www.gov.uk/car-tax-disc-without-v11-reminder','answer','352777','1.834407658','1.214956595','0.117341472','2951'] ,['https://www.gov.uk/dbs-update-service','answer','298695','2.189723237','1.318467049','0.03589255','2793'] ,['https://www.gov.uk/apply-national-insurance-number','answer','290161','2.639798061','1.817138642','0.109350445','2476'] ,['https://www.gov.uk/browse/driving','browse','1078322','1.735348727','1.171895258','0.060171596','8207'] ,['https://www.gov.uk/browse/driving/car-tax-discs','browse','785064','2.259636031','1.392965201','0.067918415','6017'] ,['https://www.gov.uk/browse/driving/driving-licences','browse','719546','1.551090427','1.033780902','0.045290453','3959'] ,['https://www.gov.uk/browse/benefits','browse','560756','1.616491391','1.070204063','0.066103866','4298'] ,['https://www.gov.uk/browse/visas-immigration','browse','300102','1.394285897','0.861546114','0.045552519','2347'] ,['https://www.gov.uk/browse/benefits/tax-credits','browse','290666','2.08884772','1.450619556','0.082990683','2259'] ,['https://www.gov.uk/browse/working','browse','247633','1.374571942','0.895719794','0.036283805','1946'] ,['https://www.gov.uk/browse/driving/learning-to-drive','browse','246129','1.285296271','0.93968339','0.065025763','1475'] ,['https://www.gov.uk/browse/abroad/passports','browse','234574','1.5927428','1.037507713','0.050746479','1493'] ,['https://www.gov.uk/browse/tax','browse','233701','1.123299509','0.71208952','0.035849891','1833'] ,['https://www.gov.uk/start-up-loans','business_support','23378','1.735593301','1.312245192','0.041703349','209'] ,['https://www.gov.uk/child-benefit-tax-calculator/main','calculator','100060','0.95861118','0.647821118','0.039937888','805'] ,['https://www.gov.uk/child-benefit-tax-calculator','calculator','57194','1.175415909','0.848981818','0.090025','440'] ,['https://www.gov.uk/bank-holidays','calendar','814429','2.947756442','1.858846154','0.067771917','6791'] ,['https://www.gov.uk/when-do-the-clocks-change','calendar','11900','3.456198113','1.735801887','0.035811321','106'] ,['https://www.gov.uk/yourstatepension','campaign','234739','3.480980065','2.727734914','0.12223653','1856'] ,['https://www.gov.uk/statepensiontopup','campaign','33837','5.680011111','4.274977778','0.169514815','270'] ,['https://www.gov.uk/floodsdestroy','campaign','31796','8.493238683','6.145382716','0.107242798','243'] ,['https://www.gov.uk/vehicletaxrules','campaign','23775','3.724149733','2.952882353','0.020010695','187'] ,['https://www.gov.uk/done/vehicle-tax','completed_transaction','1425382','2.16046774','1.527164529','0.075622016','10183'] ,['https://www.gov.uk/done/check-vehicle-tax','completed_transaction','356630','2.238557165','1.653729874','0.153767646','2624'] ,['https://www.gov.uk/driving-transaction-finished','completed_transaction','246843','2.377802372','1.421906343','0.147405352','2024'] ,['https://www.gov.uk/done/view-driving-licence','completed_transaction','240825','1.330058584','0.972969262','0.078002561','1963'] ,['https://www.gov.uk/done/make-a-sorn','completed_transaction','168843','2.374023383','1.695594848','0.090216237','1283'] ,['https://www.gov.uk/transaction-finished','completed_transaction','88642','1.905958146','1.312157186','0.053341317','669'] ,['https://www.gov.uk/done/book-driving-test','completed_transaction','82863','2.770414414','2.131402527','0.028516245','555'] ,['https://www.gov.uk/done/overseas-passports','completed_transaction','43101','2.274297619','1.509440476','0.046044643','336'] ,['https://www.gov.uk/done/change-date-practical-driving-test','completed_transaction','27533','2.202359606','1.654694581','0.098837438','203'] ,['https://www.gov.uk/done/marriage-allowance','completed_transaction','25089','1.880342105','0.932535088','0.028846491','228'] ,['https://www.gov.uk/guidance/hmrc-tools-and-calculators','detailed_guidance','89674','1.694723577','1.180822888','0.042138965','738'] ,['https://www.gov.uk/guidance/annual-tax-summary','detailed_guidance','81043','3.026364472','1.968769585','0.046956989','653'] ,['https://www.gov.uk/guidance/tax-professional-development-programme','detailed_guidance','75379','4.638122356','3.369554381','0.149279456','662'] ,['https://www.gov.uk/guidance/civil-service-fast-stream-graduate-schemes','detailed_guidance','74103','2.095938871','1.489315047','0.037909091','638'] ,['https://www.gov.uk/guidance/rates-of-vat-on-different-goods-and-services','detailed_guidance','66143','1.986718992','1.37448932','0.048963107','516'] ,['https://www.gov.uk/guidance/jobcentres-where-you-can-claim-universal-credit','detailed_guidance','63771','2.243862917','1.591653779','0.064609842','569'] ,['https://www.gov.uk/guidance/hmrc-online-services-for-agents','detailed_guidance','63697','0.732922018','0.494529002','0.010013921','436'] ,['https://www.gov.uk/guidance/civil-service-fast-stream-how-to-apply','detailed_guidance','63592','2.040547826','1.139676087','0.019854348','460'] ,['https://www.gov.uk/guidance/rates-and-thresholds-for-employers-2015-to-2016','detailed_guidance','55180','1.782179325','1.143632911','0.026415612','474'] ,['https://www.gov.uk/guidance/equality-act-2010-guidance','detailed_guidance','44030','2.184041872','1.443509852','0.02785468','406'] ,['https://www.gov.uk/business-finance-support-finder/search','finder','160127','1.113048832','0.750252654','0.104394904','471'] ,['https://www.gov.uk/business-finance-support-finder','finder','41967','1.616508772','1.139374269','0.033555556','342'] ,['https://www.gov.uk/licence-finder/sectors','finder','18040','0.863345794','0.526107477','0.054971963','214'] ,['https://www.gov.uk/licence-finder','finder','11763','2.250155172','1.530155172','0.011974138','116'] ,['https://www.gov.uk/log-in-register-hmrc-online-services','guide','1105909','0.907914613','0.605065872','0.017374808','11079'] ,['https://www.gov.uk/new-state-pension','guide','375771','0.991882245','0.623622468','0.062311234','3261'] ,['https://www.gov.uk/vehicle-tax-rate-tables','guide','332818','1.342384295','0.843072721','0.05621364','2878'] ,['https://www.gov.uk/self-assessment-tax-returns','guide','298670','1.041300235','0.654159984','0.028718553','2548'] ,['https://www.gov.uk/income-tax-rates','guide','251031','1.242352336','0.845760636','0.051732243','2140'] ,['https://www.gov.uk/income-tax-rates/current-rates-and-allowances','guide','249455','2.314474085','1.548633682','0.065519734','2103'] ,['https://www.gov.uk/disclosure-barring-service-check/overview','guide','225875','2.391589692','1.641899342','0.066298938','1979'] ,['https://www.gov.uk/register-for-self-assessment','guide','199602','1.411126803','0.91472261','0.040750996','2011'] ,['https://www.gov.uk/new-state-pension/eligibility','guide','195523','1.053483262','0.639461023','0.057804507','1643'] ,['https://www.gov.uk/disclosure-barring-service-check/tracking-application-getting-certificate','guide','189818','1.986434286','1.269380023','0.1199214','1750'] ,['https://www.gov.uk/help/beta','help_page','48548','0.872476077','0.57157554','0.030539568','418'] ,['https://www.gov.uk/help','help_page','26858','1.215348754','0.780314286','0.034053381','281'] ,['https://www.gov.uk/help/browsers','help_page','26572','2.115023585','1.415843902','0.143741463','212'] ,['https://www.gov.uk/help/cookies','help_page','18324','1.789937984','1.246904762','0.043936508','129'] ,['https://www.gov.uk/','homepage','3834589','2.413297742','1.463053584','0.048877741','32555'] ,['https://www.gov.uk/shotgun-and-firearm-certificates','licence','30255','2.412229167','1.7114875','0.07715','240'] ,['https://www.gov.uk/waste-carrier-or-broker-registration','licence','19138','1.791174194','1.061845161','0.044090323','155'] ,['https://www.gov.uk/tv-licence','licence','18491','2.365462857','1.571988571','0.082245714','175'] ,['https://www.gov.uk/hazardous-waste-producer-registration','licence','13200','1.980877358','1.49614433','0.009226804','106'] ,['https://www.gov.uk/temporary-events-notice','licence','9490','1.419169811','0.987062893','0.060874214','159'] ,['https://www.gov.uk/premises-licence','licence','9239','1.41587156','1.130559633','0.043238532','109'] ,['https://www.gov.uk/pay-council-tax','local_transaction','108560','2.07687664','1.440164042','0.05387664','762'] ,['https://www.gov.uk/apply-for-elderly-person-bus-pass','local_transaction','86399','1.977504711','1.286635628','0.066774629','743'] ,['https://www.gov.uk/school-term-holiday-dates','local_transaction','68189','2.582669091','1.965723636','0.054129091','550'] ,['https://www.gov.uk/apply-council-tax-reduction','local_transaction','65838','1.695058712','1.0833125','0.094409091','528'] ,['https://www.gov.uk/apply-for-primary-school-place','local_transaction','65219','1.977235514','1.257418692','0.053108411','535'] ,['https://www.gov.uk/get-on-electoral-register','local_transaction','59672','1.149631356','0.86854661','0.034161017','472'] ,['https://www.gov.uk/apply-for-council-housing','local_transaction','53797','1.587685714','1.184171429','0.084784615','455'] ,['https://www.gov.uk/blue-badge-scheme-information-council','local_transaction','41368','2.404148688','1.737769679','0.062157434','343'] ,['https://www.gov.uk/apply-for-council-tax-discount','local_transaction','33482','1.286489879','0.794846154','0.047299595','247'] ,['https://www.gov.uk/apply-housing-benefit-from-council','local_transaction','30205','1.296875','0.957269767','0.065180556','216'] ,['https://www.gov.uk/government/news/driving-licence-changes','news','118341','6.19678198','1.62969265','0.054374165','899'] ,['https://www.gov.uk/government/news/vehicle-tax-changes','news','73145','5.056795332','1.687448833','0.05902693','557'] ,['https://www.gov.uk/government/news/spending-review-and-autumn-statement-2015-key-announcements','news','72804','1.683813264','0.991699825','0.045066318','573'] ,['https://www.gov.uk/government/news/new-national-minimum-wage-rates-announced','news','62669','2.709677291','1.962265469','0.055722555','502'] ,['https://www.gov.uk/government/news/launch-of-the-new-companies-house-public-beta-service','news','57081','1.91729718','0.497655098','0.014331887','461'] ,['https://www.gov.uk/government/news/immigration-rules-changes','news','49269','1.692984169','1.198807388','0.05507124','379'] ,['https://www.gov.uk/government/news/uk-to-observe-a-minutes-silence-for-victims-of-the-paris-terrorist-attacks','news','44135','3.792754617','2.891662269','0.044448549','379'] ,['https://www.gov.uk/government/news/spending-review-and-autumn-statement-2015-everything-you-need-to-know','news','36342','0.952006472','0.59697411','0.024640777','309'] ,['https://www.gov.uk/government/news/transport-direct-website-closes-on-30-september-2014','news','33175','3.030919847','2.38835249','0.095141762','262'] ,['https://www.gov.uk/government/news/hiring-a-vehicle','news','31495','4.066705674','1.43372695','0.041460993','282'] ,['https://www.gov.uk/driving-theory-test-centre','place','162720','1.908049459','1.420468315','0.098295981','1294'] ,['https://www.gov.uk/number-plate-supplier','place','50458','1.026865116','0.74964186','0.042709302','430'] ,['https://www.gov.uk/find-regional-passport-office','place','41983','1.284501458','0.924820588','0.078629412','343'] ,['https://www.gov.uk/passport-interview-office','place','34223','1.505879518','1.104506024','0.07153012','249'] ,['https://www.gov.uk/compulsory-basic-training-cbt-courses','place','28013','3.32660479','1.876652695','0.01991018','167'] ,['https://www.gov.uk/health-protection-team','place','11792','0.931783784','0.606441441','0.01527027','111'] ,['https://www.gov.uk/find-atf-dvsa-test-station','place','11721','1.528632479','1.12962931','0.064784483','117'] ,['https://www.gov.uk/jobseekers-allowance/how-to-claim','programme','517121','2.067895394','1.256484552','0.054557321','4407'] ,['https://www.gov.uk/the-warm-home-discount-scheme/eligibility','programme','222238','1.472418678','1.05137723','0.061521511','1906'] ,['https://www.gov.uk/jobseekers-allowance/what-youll-get','programme','203573','1.588507303','1.00161439','0.062897753','1780'] ,['https://www.gov.uk/employment-support-allowance/how-to-claim','programme','195996','2.005792303','1.329552147','0.088635697','1637'] ,['https://www.gov.uk/jobseekers-allowance','programme','194322','1.415665867','0.823507212','0.055968788','1667'] ,['https://www.gov.uk/winter-fuel-payment/what-youll-get','programme','179816','1.746984095','1.120472462','0.104792303','1509'] ,['https://www.gov.uk/winter-fuel-payment/overview','programme','173779','3.097577056','2.025932133','0.109900277','1447'] ,['https://www.gov.uk/jobseekers-allowance/overview','programme','169642','2.804739529','1.951411649','0.066259817','1528'] ,['https://www.gov.uk/jobseekers-allowance/eligibility','programme','164853','1.766173116','1.118011549','0.093747454','1473'] ,['https://www.gov.uk/state-pension','programme','162477','1.337557034','0.853877693','0.104963878','1578'] ,['https://www.gov.uk/search','search','6511900','1.210784089','0.801749713','0.042228946','57644'] ,['https://www.gov.uk/contact-the-dvla','simple_smart_answer','1410564','1.397849482','0.945512214','0.053394152','11394'] ,['https://www.gov.uk/sold-bought-vehicle','simple_smart_answer','1138271','0.931111489','0.600344308','0.028497916','9409'] ,['https://www.gov.uk/claim-state-pension-online','simple_smart_answer','443399','1.1561543','0.70765905','0.029102696','3895'] ,['https://www.gov.uk/qualify-tax-credits','simple_smart_answer','438506','1.034497655','0.732959238','0.056668915','3412'] ,['https://www.gov.uk/settle-in-the-uk','simple_smart_answer','369041','0.803511943','0.547294383','0.031545513','3098'] ,['https://www.gov.uk/check-if-you-need-a-tax-return','simple_smart_answer','350118','0.779019651','0.499903618','0.026344354','3206'] ,['https://www.gov.uk/vehicles-can-drive','simple_smart_answer','281331','1.232023063','0.79163238','0.035751384','2168'] ,['https://www.gov.uk/legal-right-work-uk','simple_smart_answer','234155','0.750825955','0.515023003','0.022628906','2304'] ,['https://www.gov.uk/exchange-foreign-driving-licence','simple_smart_answer','201185','1.036775655','0.747343886','0.027069869','1832'] ,['https://www.gov.uk/register-employer','simple_smart_answer','182258','0.768559476','0.522612','0.021017714','1757'] ,['https://www.gov.uk/calculate-state-pension','smart_answer','3370003','1.323673649','0.781799362','0.05688553','13844'] ,['https://www.gov.uk/calculate-your-holiday-entitlement','smart_answer','1739517','1.156100457','0.712383784','0.037452599','4818'] ,['https://www.gov.uk/calculate-your-child-maintenance','smart_answer','1612490','1.924017796','1.300467853','0.070649828','3484'] ,['https://www.gov.uk/pay-leave-for-parents','smart_answer','1019333','1.261407001','0.895759677','0.061127957','1914'] ,['https://www.gov.uk/calculate-your-redundancy-pay','smart_answer','859450','1.443340382','0.96114276','0.068161202','2932'] ,['https://www.gov.uk/student-finance-calculator','smart_answer','761446','1.287060683','0.902192794','0.032221871','1582'] ,['https://www.gov.uk/maternity-paternity-calculator','smart_answer','582730','0.9024375','0.547480783','0.026960116','1456'] ,['https://www.gov.uk/calculate-statutory-sick-pay','smart_answer','372199','1.247096012','0.828138848','0.036793205','677'] ,['https://www.gov.uk/am-i-getting-minimum-wage','smart_answer','339752','1.048715871','0.759760266','0.041628191','901'] ,['https://www.gov.uk/check-uk-visa','smart_answer','338491','1.24757376','0.841644696','0.029703704','1593'] ,['https://www.gov.uk/topic/personal-tax/self-assessment','specialist-sector','470817','1.237742525','0.740827424','0.024183486','4047'] ,['https://www.gov.uk/topic/business-tax/vat','specialist-sector','304506','1.125591655','0.753375716','0.013811963','2804'] ,['https://www.gov.uk/topic/further-education-skills/apprenticeships','specialist-sector','251697','2.166331426','1.482254658','0.037946991','2097'] ,['https://www.gov.uk/topic/business-tax/paye','specialist-sector','211271','1.215260504','0.741377438','0.018665788','1904'] ,['https://www.gov.uk/topic/personal-tax/income-tax','specialist-sector','169895','1.29112069','0.825151294','0.025229595','1508'] ,['https://www.gov.uk/topic/dealing-with-hmrc/paying-hmrc','specialist-sector','156343','1.551596518','0.991156893','0.030437928','1321'] ,['https://www.gov.uk/topic/dealing-with-hmrc/tax-agent-guidance','specialist-sector','99168','1.039654948','0.710200521','0.015571615','768'] ,['https://www.gov.uk/topic/benefits-credits/tax-credits','specialist-sector','96240','1.547082383','1.013265228','0.030821066','789'] ,['https://www.gov.uk/topic/company-registration-filing/starting-company','specialist-sector','90810','1.328091969','0.724003891','0.023923476','772'] ,['https://www.gov.uk/topic/intellectual-property/trade-marks','specialist-sector','74541','0.930183511','0.57750266','0.00881516','752'] ,['https://www.gov.uk/jobsearch','transaction','4324633','3.198359068','1.888408722','0.075950826','39065'] ,['https://www.gov.uk/vehicle-tax','transaction','4114405','2.353487418','1.539265496','0.051599234','32984'] ,['https://www.gov.uk/get-information-about-a-company','transaction','2031722','0.95427395','0.567052993','0.014709628','19113'] ,['https://www.gov.uk/check-vehicle-tax','transaction','1787482','2.236185273','1.539040753','0.086508525','15210'] ,['https://www.gov.uk/pay-dartford-crossing-charge','transaction','1333059','2.656110519','1.854997236','0.054276596','10876'] ,['https://www.gov.uk/view-driving-licence','transaction','1204448','2.1289536','1.378514309','0.045585854','9806'] ,['https://www.gov.uk/register-to-vote','transaction','1155932','3.295604682','2.262534125','0.095845411','9013'] ,['https://www.gov.uk/change-driving-test','transaction','1145398','2.137030543','1.445087856','0.055782429','8218'] ,['https://www.gov.uk/get-vehicle-information-from-dvla','transaction','1020082','2.280651486','1.616397358','0.057676852','8717'] ,['https://www.gov.uk/student-finance-register-login','transaction','848938','2.377969539','1.535384431','0.080602313','7091'] ,['https://www.gov.uk/foreign-travel-advice','travel-advice','696235','1.323709716','0.904970226','0.037407287','5846'] ,['https://www.gov.uk/foreign-travel-advice/egypt','travel-advice','459565','2.697579807','1.831234647','0.097583378','3734'] ,['https://www.gov.uk/foreign-travel-advice/france','travel-advice','297766','1.857639094','1.277448244','0.059746765','2164'] ,['https://www.gov.uk/foreign-travel-advice/belgium','travel-advice','178485','1.900671063','1.297070652','0.066744763','1289'] ,['https://www.gov.uk/foreign-travel-advice/turkey','travel-advice','102138','2.422057572','1.720808511','0.080863579','799'] ,['https://www.gov.uk/foreign-travel-advice/morocco','travel-advice','82995','1.901528358','1.352938806','0.048067164','670'] ,['https://www.gov.uk/foreign-travel-advice/spain','travel-advice','61100','1.5977473','1.112637744','0.080967603','463'] ,['https://www.gov.uk/foreign-travel-advice/usa','travel-advice','59144','1.549398773','1.015507157','0.035492843','489'] ,['https://www.gov.uk/foreign-travel-advice/usa/entry-requirements','travel-advice','58369','1.788462168','1.227586912','0.071386503','489'] ,['https://www.gov.uk/foreign-travel-advice/tunisia','travel-advice','48475','2.117009828','1.496646192','0.059378378','407']]
# define dataframe
headings = ['URL', 'Format', 'Pageviews', 'Page load time', 'Interactive doc time', 'Download time', 'Sample size', 'Title', 'PageSpeed score', 'Total Resource count', 'Total Request Bytes', 'Static Resource count', 'CSS Resource count', 'CSS Response Bytes', 'Flash Response Bytes', 'Host Count', 'HTML Response Bytes', 'Image Response Bytes', 'JavaScript Resource Count', 'JavaScript Response Bytes', 'Text Response Bytes', 'Other Response Bytes']
table = []
speed = pd.DataFrame(columns=headings, data=table)

# loop through each url
for page in url:
    analysis = service.analyze(page[0])
    stats = analysis.statistics
    # get data into list
    newrow = [page[0], page[1], page[2], page[3], page[4], page[5], page[6],analysis.title, analysis.score, stats.resource_count,
     stats.total_request_bytes, stats.static_resource_count,
     stats.css_resource_count, stats.css_response_bytes,
     stats.flash_response_bytes, stats.host_count,
     stats.html_response_bytes, stats.image_response_bytes,
     stats.javascript_resource_count,
     stats.javascript_response_bytes, stats.text_response_bytes,
     stats.other_response_bytes]
    # turn data list  into dataframe
    newrowdf = pd.Series(newrow, index=headings)
    # append dataframe to main dataframe
    speed = speed.append(newrowdf, ignore_index=True)

print speed
speed.to_csv('pagespeed-results.csv',encoding='utf-8')
